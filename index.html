<!DOCTYPE html>

<head>
	<title>JS Loading Bar</title>
	<meta charset="utf8">
	<link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>

    <section class="target-bar-container">
        <div class="target-wrap progress" data-progress-percent="">
        <div class="target-bar progress">
        </div>
        </div>
    </section>
    <h1>
        £<span class='target-amount'></span>
    </h1>
    <h3>
        £<span class='money-raised'></span>
    </h3>

    <button class='increase-donation'>^</button>
    <button class='decrease-donation'>!</button>

    Donate: <input type='text' name='donation-amount'>
            <input type="submit" value="Submit">
				

	<script src='src/TargetBar.js'></script>
	<script src='https://code.jquery.com/jquery-2.0.3.min.js'></script>
    <script>
        moveProgressBar();
        $(window).resize(function() {
            moveProgressBar();
        });

        function moveProgressBar() {
            var targetbar = new TargetBar(200, 500);

            var getPercent = (targetbar.percentage()) / 100;
            var getTargetWrapHeight = $('.target-wrap').height();
            var progressTotal = getPercent * getTargetWrapHeight;
            var animationLength = 2500;

            // Display target amount
            $('.target-amount').text(targetbar.targetAmount);
            // Display money raised so far
            $('.money-raised').text(targetbar.amount);
            // Add current progress as a class to indicate colour of the bar
            $('.target-wrap').addClass(targetbar.progress())
            
            $('.increase-donation').on('click', function() {
                targetbar.addMoney(10);
                // Update amount
                $('.money-raised').text(targetbar.amount);
                // Update class to change colour of bar
                $('.target-wrap').attr('class', 'target-wrap progress').addClass(targetbar.progress())
                // Update position of bar
                $('.target-bar').animate({
                    bottom: '+=2%'
                }, 300);
            });

            $('.decrease-donation').on('click', function() {
                targetbar.subtractMoney(10);
                $('.money-raised').text(targetbar.amount);
                $('.target-wrap').attr('class', 'target-wrap progress').addClass(targetbar.progress())
                $('.target-bar').animate({
                    bottom: '-=2%'
                }, 300);
            });

            // on page load, animate percentage bar to current donation percentage
            // .stop() used to prevent animation queueing
            $('.target-bar').stop().animate({
                bottom: progressTotal
            }, animationLength);
        }

    </script>

</body>